# Use the official Prefect image for Python 3.12
FROM prefecthq/prefect:3-python3.12

# Create non-root user for security
RUN groupadd -r prefect && \
    useradd -r -g prefect -u 1001 -m prefect && \
    mkdir -p /app /data && \
    chown -R prefect:prefect /app /data

# Set working directory
WORKDIR /app

# Switch to non-root user
USER prefect

CMD ["prefect", "server", "start", "--port", "4200"]
